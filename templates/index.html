{% extends 'base.html' %}
{% block content %}
<section class="card">
  <h2>Upload PDF</h2>
  <form class="grid" action="/upload" method="post" enctype="multipart/form-data">
    <label class="file-input">
      <span>Select a PDF</span>
      <input type="file" name="file" accept="application/pdf" required />
    </label>
    <select name="model" title="Embedding model">
      <option value="BAAI/bge-small-en-v1.5" selected>BAAI/bge-small-en-v1.5</option>
      <option value="all-MiniLM-L6-v2">all-MiniLM-L6-v2</option>
    </select>
    <select name="index_type" title="FAISS index type">
      <option value="IP" selected>IndexFlatIP (cosine)</option>
      <option value="L2">IndexFlatL2</option>
    </select>
    <button type="submit">Upload</button>
  </form>
  <p class="muted">PDF is parsed into text chunks, images, and tables. Indexes are updated.</p>
  <details>
    <summary>Notes</summary>
    <ul>
      <li>Uses Unstructured with layout-aware chunking.</li>
      <li>Captions are placeholders for now.</li>
      <li>Embeddings via sentence-transformers; FAISS IndexFlatIP.</li>
    </ul>
  </details>
</section>

<section class="card">
  <h2>Search</h2>
  <form class="grid" action="/search" method="get">
    <input type="text" name="query" placeholder="Search your PDFs..." required />
    <input type="number" name="k" min="1" max="10" value="3" />
    <select name="model" title="Embedding model">
      <option value="BAAI/bge-small-en-v1.5" selected>BAAI/bge-small-en-v1.5</option>
      <option value="all-MiniLM-L6-v2">all-MiniLM-L6-v2</option>
    </select>
    <select name="index_type" title="FAISS index type">
      <option value="IP" selected>IndexFlatIP (cosine)</option>
      <option value="L2">IndexFlatL2</option>
    </select>
    <button type="submit">Search (JSON)</button>
  </form>
  <p class="muted">Returns JSON: text hits with citations and image results with paths.</p>
</section>
{% endblock %}


